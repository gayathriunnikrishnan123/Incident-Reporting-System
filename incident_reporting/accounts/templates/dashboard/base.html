{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}Dashboard{% endblock %}</title>
    <link rel="stylesheet" href="{% static "css/dashBase.css" %}">
    {% block headersPart %}{% endblock headersPart %}
     <style>
        {% block extra_css %}{% endblock %}
    </style> 

    
</head>
<body>
    
    <div class="dashboard-container">
    <!-- Sidebar Toggle Button (moved outside sidebar) -->
    

    <!-- Sidebar -->
    <aside class="sidebar" id="sidebar">
        <div class="sidebar-header">
            <div class="logo">F</div>
            <span style="font-weight: 600; color: #111827;">SK</span>
            <div class="sidebar-toggle" onclick="toggleSidebar()" title="Toggle Sidebar">
                <span id="toggle-icon">‚Üê</span>
            </div>
        </div>

<nav class="sidebar-nav">
    <!-- Essentials Section -->
    <div class="nav-section">
        <div class="nav-section-title">Essentials</div>
        <a href="{% url 'dashboard' %}" class="nav-item">
            <div class="nav-icon">üìä</div>
            Dashboard
        </a>
        
        <!-- Only show System Config to admins -->
        {% if is_admin %}
        <a href="{% url 'system-config' %}" class="nav-item">
            <div class="nav-icon">‚öôÔ∏è</div>
            System Configuration
        </a>
        {% endif %}
        
        <!-- Only show User Management to admins -->
        {% if is_admin %}
        <a href="{% url 'user-management' %}" class="nav-item">
            <div class="nav-icon">üë•</div>
            User Management
        </a>
        {% endif %}
        
        <!-- Show appropriate incident label -->
        <a href="#" class="nav-item">
            <div class="nav-icon">üì¶</div>
            {% if is_responder %}My Incidents{% else %}All Incidents{% endif %}
        </a>
        
        <!-- Show Audit Log to reviewers and admins -->
        {% if is_reviewer or is_admin %}
        <a href="{% url 'auditlog' %}" class="nav-item">
            <div class="nav-icon">üìç</div>
            Audit Log
        </a>
        {% endif %}
    </div>

    <!-- Reports Section -->
    <div class="nav-section">
        <div class="nav-section-title">Reports</div>
        <a href="#" class="nav-item">
            <div class="nav-icon">üìã</div>
            Incident Reports
        </a>
        <!-- Show Analytics to reviewers and admins -->
        {% if is_reviewer or is_admin %}
        <a href="#" class="nav-item">
            <div class="nav-icon">üìà</div>
            Analytics
        </a>
        {% endif %}
    </div>

    <!-- System Section (visible to all logged-in users) -->
    <div class="nav-section">
        <div class="nav-section-title">System</div>
        <a href="{% url 'password_change' %}" class="nav-item">
            <div class="nav-icon">üîë</div>
            Change Password
        </a>
        <a href="{% url 'logout' %}" class="nav-item">
            <div class="nav-icon">üö™</div>
            Log Out
        </a>
        <a href="#" class="nav-item" onclick="toggleDarkMode()">
            <div class="nav-icon">{% if is_dark_mode %}‚òÄÔ∏è{% else %}üåô{% endif %}</div>
            {% if is_dark_mode %}Light{% else %}Dark{% endif %} Mode
        </a>
    </div>
</nav>

        <!-- User Profile (moved to bottom via flex) -->
        <div class="user-profile">
            <div class="user-avatar">HN</div>
            <div class="user-info">
                <h4>{{ request.user.get_full_name|default:request.user.fullname }}</h4>
                <p>Admin Manager</p>
            </div>
        </div>
    </aside>

    <!-- Main Content -->
    <main class="main-content">
        <header class="header">
            <h1>{% block page_title %}Dashboard{% endblock %}</h1>
            <div class="header-actions">
                <span class="time-period">{% block time_period %}{% now "M d, Y" %}{% endblock %}</span>
                {% block header_actions %}{% endblock %}
            </div>
        </header>

        <div class="content">
            {% block content %}
            <!-- Dashboard Content -->

            {% endblock content %}
        </div>
    </main>
</div>


    {% comment %} <script>
        // Minimal JavaScript for basic functionality
        function toggleDarkMode() {
            // Add your dark mode toggle logic here
            alert('Dark mode toggle - implement as needed');
        }

        // Mobile menu toggle (if needed)
        function toggleSidebar() {
            const sidebar = document.querySelector('.sidebar');
            sidebar.classList.toggle('open');
        }

        // Add mobile menu button if needed
        if (window.innerWidth <= 768) {
            const header = document.querySelector('.header');
            const menuBtn = document.createElement('button');
            menuBtn.innerHTML = '‚ò∞';
            menuBtn.onclick = toggleSidebar;
            menuBtn.style.cssText = 'background:none;border:none;font-size:20px;cursor:pointer;';
            header.insertBefore(menuBtn, header.firstChild);
        }

        {% block extra_js %}{% endblock %}
    </script> {% endcomment %}
    <script>
        // Dark Mode Toggle
        let isDarkMode = localStorage.getItem('darkMode') === 'true';
        
        function toggleDarkMode() {
            isDarkMode = !isDarkMode;
            document.body.classList.toggle('dark-mode', isDarkMode);
            localStorage.setItem('darkMode', isDarkMode);
            
            // Update dark mode icon
            const darkModeIcon = document.querySelector('a[onclick*="toggleDarkMode"] .nav-icon');
            if (darkModeIcon) {
                darkModeIcon.textContent = isDarkMode ? '‚òÄÔ∏è' : 'üåô';
            }
        }

        // Initialize dark mode on page load
        if (isDarkMode) {
            document.body.classList.add('dark-mode');
            const darkModeIcon = document.querySelector('a[onclick*="toggleDarkMode"] .nav-icon');
            if (darkModeIcon) {
                darkModeIcon.textContent = '‚òÄÔ∏è';
            }
        }

        // Sidebar Toggle
        {% comment %} let isSidebarMinimized = localStorage.getItem('sidebarMinimized') === 'true';
        
        function toggleSidebar() {
            const sidebar = document.getElementById('sidebar');
            const mainContent = document.querySelector('.main-content');
            const toggleIcon = document.getElementById('toggle-icon');
            
            isSidebarMinimized = !isSidebarMinimized;
            
            if (isSidebarMinimized) {
                sidebar.classList.add('minimized');
                toggleIcon.textContent = '‚Üí';
                mainContent.style.marginLeft = '70px';
            } else {
                sidebar.classList.remove('minimized');
                toggleIcon.textContent = '‚Üê';
                mainContent.style.marginLeft = '280px';
            }
            
            localStorage.setItem('sidebarMinimized', isSidebarMinimized);
        } {% endcomment %}

        // Initialize sidebar state on page load
        {% comment %} if (isSidebarMinimized) {
            const sidebar = document.getElementById('sidebar');
            const mainContent = document.querySelector('.main-content');
            const toggleIcon = document.getElementById('toggle-icon');
            
            sidebar.classList.add('minimized');
            toggleIcon.textContent = '‚Üí';
            mainContent.style.marginLeft = '70px';
        } {% endcomment %}

        // Mobile menu toggle
        function toggleMobileSidebar() {
            const sidebar = document.getElementById('sidebar');
            sidebar.classList.toggle('open');
        }
        
        function toggleSidebar() {
        const sidebar = document.getElementById('sidebar');
        sidebar.classList.toggle('minimized');

        const icon = document.getElementById('toggle-icon');
        icon.textContent = sidebar.classList.contains('minimized') ? '‚Üí' : '‚Üê';
    }

        // Mobile menu setup
        if (window.innerWidth <= 768) {
            const header = document.querySelector('.header');
            const menuBtn = document.createElement('button');
            menuBtn.innerHTML = '‚ò∞';
            menuBtn.onclick = toggleMobileSidebar;
            menuBtn.style.cssText = 'background:none;border:none;font-size:20px;cursor:pointer;margin-right:15px;';
            header.insertBefore(menuBtn, header.firstChild);
        }

        // Handle window resize
        window.addEventListener('resize', function() {
            if (window.innerWidth > 768) {
                const sidebar = document.getElementById('sidebar');
                sidebar.classList.remove('open');
            }
        });

        
    </script>
    {% block extra_js %}{% endblock %}
</body>
</html>